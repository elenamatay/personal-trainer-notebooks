<<<<<<< HEAD
"""For debug purpose we are replacing actual builtin property by the debug property
"""
=======
'''For debug purpose we are replacing actual builtin property by the debug property
'''
>>>>>>> 18d7037cf30f05fb9c835180cb251f94a7f2d64c
from _pydevd_bundle.pydevd_comm import get_global_debugger
from _pydev_bundle import pydev_log


<<<<<<< HEAD
# =======================================================================================================================
# replace_builtin_property
# =======================================================================================================================
=======
#=======================================================================================================================
# replace_builtin_property
#=======================================================================================================================
>>>>>>> 18d7037cf30f05fb9c835180cb251f94a7f2d64c
def replace_builtin_property(new_property=None):
    if new_property is None:
        new_property = DebugProperty
    original = property
    try:
        import builtins
<<<<<<< HEAD

        builtins.__dict__["property"] = new_property
=======
        builtins.__dict__['property'] = new_property
>>>>>>> 18d7037cf30f05fb9c835180cb251f94a7f2d64c
    except:
        pydev_log.exception()  # @Reimport
    return original


<<<<<<< HEAD
# =======================================================================================================================
# DebugProperty
# =======================================================================================================================
=======
#=======================================================================================================================
# DebugProperty
#=======================================================================================================================
>>>>>>> 18d7037cf30f05fb9c835180cb251f94a7f2d64c
class DebugProperty(object):
    """A custom property which allows python property to get
    controlled by the debugger and selectively disable/re-enable
    the tracing.
    """

    def __init__(self, fget=None, fset=None, fdel=None, doc=None):
        self.fget = fget
        self.fset = fset
        self.fdel = fdel
        self.__doc__ = doc

    def __get__(self, obj, objtype=None):
        if obj is None:
            return self
        global_debugger = get_global_debugger()
        try:
            if global_debugger is not None and global_debugger.disable_property_getter_trace:
                global_debugger.disable_tracing()
            if self.fget is None:
                raise AttributeError("unreadable attribute")
            return self.fget(obj)
        finally:
            if global_debugger is not None:
                global_debugger.enable_tracing()

    def __set__(self, obj, value):
        global_debugger = get_global_debugger()
        try:
            if global_debugger is not None and global_debugger.disable_property_setter_trace:
                global_debugger.disable_tracing()
            if self.fset is None:
                raise AttributeError("can't set attribute")
            self.fset(obj, value)
        finally:
            if global_debugger is not None:
                global_debugger.enable_tracing()

    def __delete__(self, obj):
        global_debugger = get_global_debugger()
        try:
            if global_debugger is not None and global_debugger.disable_property_deleter_trace:
                global_debugger.disable_tracing()
            if self.fdel is None:
                raise AttributeError("can't delete attribute")
            self.fdel(obj)
        finally:
            if global_debugger is not None:
                global_debugger.enable_tracing()

    def getter(self, fget):
<<<<<<< HEAD
        """Overriding getter decorator for the property"""
=======
        """Overriding getter decorator for the property
        """
>>>>>>> 18d7037cf30f05fb9c835180cb251f94a7f2d64c
        self.fget = fget
        return self

    def setter(self, fset):
<<<<<<< HEAD
        """Overriding setter decorator for the property"""
=======
        """Overriding setter decorator for the property
        """
>>>>>>> 18d7037cf30f05fb9c835180cb251f94a7f2d64c
        self.fset = fset
        return self

    def deleter(self, fdel):
<<<<<<< HEAD
        """Overriding deleter decorator for the property"""
        self.fdel = fdel
        return self
=======
        """Overriding deleter decorator for the property
        """
        self.fdel = fdel
        return self

>>>>>>> 18d7037cf30f05fb9c835180cb251f94a7f2d64c
